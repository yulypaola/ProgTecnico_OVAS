<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OVA: Unidad 2 ‚Äî Estructuras de control iterativas (bucles)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
    body { font-family: 'Poppins', sans-serif; }
    .sidebar-link { transition: all .3s ease; border-left: 4px solid transparent; }
    .sidebar-link.active, .sidebar-link:hover { background:#e6f4ea; color:#166534; border-left-color:#22c55e; }
    .content-pane { display:none; animation:fadeIn .5s ease-in-out; }
    .content-pane.active { display:block; }
    @keyframes fadeIn { from {opacity:0; transform:translateY(20px)} to {opacity:1; transform:translateY(0)} }
    .quiz-option:hover { background:#f0fdf4; }
    .quiz-option.selected { background:#dcfce7; border-color:#22c55e; }

    /* Tooltip */
    .tooltip { position: relative; display:inline-block; cursor:pointer; font-weight:600; color:#0f5132; }
    .tooltip .tooltiptext {
      visibility:hidden; width:280px; background:#0f5132; color:#fff; text-align:left; border-radius:6px; padding:10px; font-size:14px; font-weight:400;
      position:absolute; z-index:30; bottom:125%; left:50%; transform:translateX(-50%); opacity:0; transition:opacity .35s; pointer-events:none;
    }
    .tooltip:hover .tooltiptext { visibility:visible; opacity:1; }

    /* TTS FAB */
    .tts-fab{ width:64px; height:64px; border-radius:9999px; background:#10b981; color:#fff; border:none; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:28px; box-shadow:0 8px 18px rgba(16,185,129,.35); }
    .tts-fab.muted{ background:#9ca3af; }
  </style>
</head>
<body class="bg-slate-50">

<div class="flex h-screen">
  <!-- ASIDE -->
  <aside class="w-64 bg-white shadow-lg flex-shrink-0 hidden md:flex md:flex-col md:sticky md:top-0 md:h-screen md:overflow-y-auto border-r">
    <div class="p-4">
      <div style="width:150px;height:150px" class="p-2 mx-auto flex items-center justify-center bg-white rounded-full shadow-lg border-2 border-green-500">
        <img src="img/logo.webp" alt="Logo OVA" class="w-5/6 h-5/6 object-contain" loading="lazy"/>
      </div>
    </div>

    <nav class="mt-6 flex-1" role="navigation" aria-label="Secciones del OVA">
      <a href="#" class="sidebar-link active flex items-center py-3 px-6 font-medium text-slate-700" data-target="introduccion" aria-label="Introducci√≥n">
        <span class="mr-3 text-xl">üöÄ</span> Introducci√≥n
      </a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="objetivos" aria-label="Objetivos">
        <span class="mr-3 text-xl">üéØ</span> Objetivos
      </a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="contenido" aria-label="Contenido">
        <span class="mr-3 text-xl">üìö</span> Contenido
      </a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="actividades" aria-label="Actividades">
        <span class="mr-3 text-xl">‚úçÔ∏è</span> Actividades
      </a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="evaluacion" aria-label="Evaluaci√≥n">
        <span class="mr-3 text-xl">‚úîÔ∏è</span> Evaluaci√≥n
      </a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="recursos" aria-label="Recursos">
        <span class="mr-3 text-xl">üìñ</span> Recursos
      </a>
      <a href="#" class="sidebar-link flex items-center py-3 px-6 font-medium text-slate-700" data-target="bibliografia" aria-label="Bibliograf√≠a">
        <span class="mr-3 text-xl">üìö</span> Bibliograf√≠a
      </a>
    </nav>

    <div class="aside-tts border-t border-emerald-100 p-4">
      <button id="menu-tts-toggle" type="button" aria-pressed="false" class="tts-fab muted" title="Voz desactivada" aria-label="Voz desactivada">üîá</button>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="flex-1 p-4 sm:p-6 md:p-10 bg-gray-50 max-h-screen overflow-y-auto">

    <!-- Logo m√≥vil -->
    <div class="md:hidden mb-6 flex flex-col items-center">
      <div style="width:100px;height:100px" class="p-2 flex items-center justify-center bg-white rounded-full shadow-lg mb-2">
        <img src="img/logo.webp" alt="Logo OVA" class="w-5/6 h-5/6 object-contain" loading="lazy"/>
      </div>
      <select id="mobile-nav" class="w-full mt-2 p-2 border rounded-md bg-white shadow-sm">
        <option value="introduccion">üöÄ Introducci√≥n</option>
        <option value="objetivos">üéØ Objetivos</option>
        <option value="contenido">üìö Contenido</option>
        <option value="actividades">‚úçÔ∏è Actividades</option>
        <option value="evaluacion">‚úîÔ∏è Evaluaci√≥n</option>
        <option value="recursos">üìñ Recursos</option>
        <option value="bibliografia">üìö Bibliograf√≠a</option>
      </select>
    </div>

    <!-- INTRODUCCI√ìN -->
    <section id="introduccion" class="content-pane active">
      <div class="flex justify-end">
        <div class="space-y-1">
          <div class="speech-controls p-2 bg-emerald-100 rounded-lg flex items-center flex-wrap gap-2 text-sm" data-target="introduccion">
            <button class="play-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-1 px-3 rounded-full flex items-center"><span class="mr-1">‚ñ∂Ô∏è</span> Leer</button>
            <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚è∏Ô∏è</span> Pausar</button>
            <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚èπÔ∏è</span> Detener</button>
            <div class="flex items-center ml-2">
              <label class="text-xs text-emerald-800 mr-2">Velocidad:</label>
              <input type="range" class="speech-rate w-24" min="0.5" max="2" step="0.1" value="1"/>
            </div>
          </div>
          <div class="p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800 text-right max-w-xl w-full ml-auto">
            <strong>üí° Atajos:</strong> <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Espacio</kbd> reproducir/pausar ¬∑ <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Tab</kbd> detener
          </div>
        </div>
      </div>

      <h1 class="text-2xl sm:text-3xl font-extrabold text-emerald-800">Unidad 2: Estructuras de control iterativas (bucles)</h1>
      <p class="mt-4 leading-relaxed">
        Las <strong>estructuras iterativas</strong> permiten repetir un conjunto de instrucciones de manera controlada mientras se cumpla una condici√≥n o durante un n√∫mero definido de veces. 
        En esta unidad aprender√°s a utilizar los ciclos <strong>Para (For)</strong>, <strong>Mientras (While)</strong> y <strong>Repetir Mientras Que (Do‚ÄìWhile)</strong>, para ejecutar instrucciones m√∫ltiples veces sin necesidad de escribirlas repetidamente. Su aplicaci√≥n facilita desde tareas sencillas, como mostrar tablas de multiplicar o calcular promedios, hasta procesos relacionados con el desarrollo web, como validar datos de forma continua o simular la adici√≥n de productos en un carrito de compras, convirti√©ndose en una herramienta indispensable para resolver problemas de manera eficiente.
      </p>

      <div class="mt-6 p-4 bg-emerald-50 border-l-4 border-emerald-500 rounded-r-lg">
        <p class="text-emerald-900">
          Usa el men√∫ para navegar por objetivo, contenido, actividades, evaluaci√≥n y recursos.
        </p>
      </div>
    </section>

    <!-- OBJETIVOS -->
    <section id="objetivos" class="content-pane">
      <div class="flex justify-end">
        <div class="space-y-1">
          <div class="speech-controls p-2 bg-emerald-100 rounded-lg flex items-center flex-wrap gap-2 text-sm" data-target="objetivos">
            <button class="play-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-1 px-3 rounded-full flex items-center"><span class="mr-1">‚ñ∂Ô∏è</span> Leer</button>
            <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚è∏Ô∏è</span> Pausar</button>
            <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚èπÔ∏è</span> Detener</button>
            <div class="flex items-center ml-2">
              <label class="text-xs text-emerald-800 mr-2">Velocidad:</label>
              <input type="range" class="speech-rate w-24" min="0.5" max="2" step="0.1" value="1"/>
            </div>
          </div>
          <div class="p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800 text-right max-w-xl w-full ml-auto">
            <strong>üí° Atajos:</strong> <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Espacio</kbd> reproducir/pausar ¬∑ <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Tab</kbd> detener
          </div>
        </div>
      </div>

      <h2 class="text-2xl sm:text-3xl font-bold text-emerald-800 mb-4">Objetivo</h2>
      <p class="leading-relaxed">
        Comprender el concepto de iteraci√≥n y las diferencias entre ejecuci√≥n <strong>secuencial, condicional e iterativa</strong>, reconociendo el papel de las estructuras de control como herramientas para automatizar procesos repetitivos y aplicarlas en la construcci√≥n de algoritmos que permitan resolver problemas pr√°cticos.
      </p>
    </section>

    <!-- CONTENIDO -->
    <section id="contenido" class="content-pane">
      <!-- TTS del acorde√≥n -->
      <div class="flex justify-end">
        <div class="space-y-1">
          <div class="speech-controls p-2 bg-emerald-100 rounded-lg flex items-center flex-wrap gap-2 text-sm" data-mode="accordion" data-container="#contenido">
            <button class="play-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-1 px-3 rounded-full flex items-center"><span class="mr-1">‚ñ∂Ô∏è</span> Leer</button>
            <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚è∏Ô∏è</span> Pausar</button>
            <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚èπÔ∏è</span> Detener</button>
            <div class="flex items-center ml-2">
              <label class="text-xs text-emerald-800 mr-2">Velocidad:</label>
              <input type="range" class="speech-rate w-24" min="0.5" max="2" step="0.1" value="1"/>
            </div>
          </div>
          <div class="p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800 text-right max-w-xl w-full ml-auto">
            <strong>üí° Atajos:</strong> <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Espacio</kbd> reproducir/pausar ¬∑ <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Tab</kbd> detener
          </div>
        </div>
      </div>

      <div class="space-y-4">

        <!-- 3.1 Concepto de iteraci√≥n -->
        <details class="group bg-white border border-emerald-200 rounded-lg shadow-sm" open>
          <summary class="cursor-pointer list-none p-4 font-bold text-emerald-800 flex items-center justify-between">
            3.1 Concepto de iteraci√≥n
            <span class="transition-transform group-open:rotate-45 text-xl">Ôºã</span>
          </summary>
          <div class="px-4 pb-4 text-slate-700 space-y-3">
            <p>
              La <strong>iteraci√≥n</strong> es el proceso de ejecutar repetidamente un conjunto de instrucciones de forma controlada hasta que se cumpla una condici√≥n o se alcance un n√∫mero espec√≠fico de repeticiones. 
              Permite automatizar tareas repetitivas y optimizar el c√≥digo al evitar duplicaci√≥n de instrucciones.
            </p>
            <figure class="bg-white border border-emerald-200 rounded-lg p-4">
              <figcaption class="font-semibold text-emerald-800 mb-2">Figura 1. Ejemplo cotidiano de iteraci√≥n: preparar jugo para 5 personas</figcaption>
              <img src="img/Figura 1.png" alt="Ilustraci√≥n de pasos repetidos para preparar jugo a varias personas" class="w-full object-contain rounded"/>
            </figure>
             <p>
              Este ejemplo permite comprender c√≥mo las iteraciones est√°n presentes en la vida cotidiana, en el caso de preparar jugo para cinco personas, las acciones se repiten una y otra vez siguiendo la misma secuencia de pasos hasta completar la cantidad deseada. De manera an√°loga, en programaci√≥n, las estructuras iterativas como ‚Äúmientras‚Äù, ‚Äúpara‚Äù o ‚Äúrepetir‚Äù permiten ejecutar un bloque de instrucciones varias veces, lo que facilita la automatizaci√≥n de tareas y el manejo eficiente de grandes vol√∫menes de datos sin necesidad de escribir c√≥digo repetitivo.
            </p>
          </div>
        </details>

        <!-- 3.2 Diferencia entre secuencial, condicional e iterativa -->
        <details class="group bg-white border border-emerald-200 rounded-lg shadow-sm">
          <summary class="cursor-pointer list-none p-4 font-bold text-emerald-800 flex items-center justify-between">
            3.2 Diferencia entre ejecuci√≥n secuencial, condicional e iterativa
            <span class="transition-transform group-open:rotate-45 text-xl">Ôºã</span>
          </summary>
          <div class="px-4 pb-4 text-slate-700 space-y-3">
            <p>
              La <strong>ejecuci√≥n secuencial</strong> sigue las instrucciones en el orden escrito; la <strong>condicional</strong> permite tomar decisiones seg√∫n se cumpla una condici√≥n; 
              la <strong>iterativa</strong> repite instrucciones m√∫ltiples veces hasta cumplir una condici√≥n o agotar un conteo.
            </p>
            <figure class="bg-white border border-emerald-200 rounded-lg p-4">
              <figcaption class="font-semibold text-emerald-800 mb-2">Figura 2. Comparaci√≥n entre ejecuci√≥n secuencial, condicional e iterativa</figcaption>
              <img src="img/Figura 2.png" alt="Tabla comparativa de secuencial, condicional e iterativa" class="w-full object-contain rounded"/>
            </figure>
            <p>
               Para comprender mejor c√≥mo se representan en la pr√°ctica los diferentes tipos de ejecuci√≥n dentro de un algoritmo, podemos observar su aplicaci√≥n en PSeInt, una herramienta que facilita la escritura y visualizaci√≥n de pseudoc√≥digo. En los siguientes ejemplos se muestra c√≥mo se ver√≠an en este entorno las estructuras secuencial, condicional e iterativa, permitiendo identificar con claridad el orden de ejecuci√≥n, las decisiones l√≥gicas y los ciclos repetitivos que caracterizan a cada una.
            </p>
            <figure class="bg-white border border-emerald-200 rounded-lg p-4">
              <figcaption class="font-semibold text-emerald-800 mb-2">Figura 3. Ejemplos en PSeInt: secuencial, condicional e iterativa</figcaption>
              <img src="img/Figura 3.png" alt="Capturas con ejemplos en PSeInt: secuencial, condicional e iterativa" class="w-full object-contain rounded"/>
            </figure>
            <p>
              Como se aprecia en los ejemplos, cada estructura cumple un prop√≥sito espec√≠fico dentro del dise√±o de algoritmos: la secuencia organiza las instrucciones de manera lineal, la condici√≥n permite tomar decisiones l√≥gicas, y la iteraci√≥n facilita la repetici√≥n controlada de procesos. Comprender y aplicar correctamente estas tres formas de ejecuci√≥n es fundamental para desarrollar programas eficientes y estructurados. A partir de esta base, en el siguiente apartado se profundizar√° en el uso pr√°ctico de las estructuras iterativas, sus tipos y la forma en que contribuyen a la automatizaci√≥n de tareas dentro de un programa.            </p>
          </div>
        </details>

        <!-- 3.3 Tipos de ciclos repetitivos -->
        <details class="group bg-white border border-emerald-200 rounded-lg shadow-sm">
          <summary class="cursor-pointer list-none p-4 font-bold text-emerald-800 flex items-center justify-between">
            3.3 Tipos de ciclos repetitivos (Para, Mientras, Repetir Mientras Que)
            <span class="transition-transform group-open:rotate-45 text-xl">Ôºã</span>
          </summary>
          <div class="px-4 pb-4 text-slate-700 space-y-6">
            <p>
              En programaci√≥n estructurada existen tres ciclos fundamentales: <strong>Para (For)</strong>, <strong>Mientras (While)</strong> y <strong>Repetir Mientras Que (Do‚ÄìWhile)</strong>. 
              Cada uno controla la repetici√≥n de manera distinta, seg√∫n el momento de evaluaci√≥n de la condici√≥n y el tipo de tarea a automatizar.
            </p>
            <figure class="bg-white border border-emerald-200 rounded-lg p-4">
              <figcaption class="font-semibold text-emerald-800 mb-2">Figura 4. ¬øQu√© tipo de bucle usar?</figcaption>
              <img src="img/Figura 41.png" alt="¬øQu√© tipo de bucle usar?" class="w-full object-contain rounded"/>
            </figure>
            <!-- 3.3.1 Para -->
            <article class="space-y-3">
              <h4 class="text-xl font-bold text-emerald-800">3.3.1 Ciclo Para (For)</h4>
              <p>Se emplea cuando se conoce el n√∫mero de repeticiones. Estructura en PSeInt:</p>
              <pre class="bg-slate-900 text-slate-100 p-4 rounded overflow-auto"><code>Para variable = valor_inicial Hasta valor_final Con Paso incremento Hacer
           
    // Instrucciones
FinPara</code></pre>
             <p> 
                Este tipo de ciclo se basa en tres elementos esenciales que son el inicializador, la finalizaci√≥n y el actualizador, como se indica a continuaci√≥n.
             </p>
              <figure class="bg-white border border-emerald-200 rounded-lg p-4">
              <figcaption class="font-semibold text-emerald-800 mb-2">Figura 5. Elementos esenciales del ciclo for</figcaption>
              <img src="img/Figura 42.png" alt="Elementos esenciales del ciclo for" class="w-full object-contain rounded"/>
            </figure>
              
            
              <p>Componentes: <strong>inicio</strong> (ej. <code>i = 1</code>), <strong>condici√≥n de fin</strong> (ej. <code>Hasta 10</code>), <strong>actualizador</strong> (ej. <code>Con Paso 1</code>).</p>
              <pre class="bg-slate-900 text-slate-100 p-4 rounded overflow-auto"><code>Proceso TablaDelCinco
   Definir i, r Como Entero
   Para i = 1 Hasta 10 Con Paso 1 Hacer
      r = 5 * i
      Escribir "5 x ", i, " = ", r
   FinPara
FinProceso</code></pre>
               <p> 
                A continuaci√≥n, se presenta un ejemplo en PseInt que muestra c√≥mo generar la tabla del 5:
             </p>
              <figure class="bg-white border border-emerald-200 rounded-lg p-4">
                <figcaption class="font-semibold text-emerald-800 mb-2">Figura 6. Ejemplo de ciclo Para (PSeInt)</figcaption>
                <img src="img/Figura 4.png" alt="Ejemplo de ciclo Para en PSeInt" class="w-full object-contain rounded"/>
              </figure>
            </article>

            <!-- 3.3.2 Mientras -->
            <article class="space-y-3">
              <h4 class="text-xl font-bold text-emerald-800">3.3.2 Ciclo Mientras (While)</h4>
              <p>Repite un bloque <em>mientras</em> la condici√≥n sea verdadera. Es ideal para situaciones en las que no se conoce con exactitud cu√°ntas veces debe repetirse el proceso, ya que la cantidad de iteraciones depende del cumplimiento de una condici√≥n l√≥gica. A diferencia del ciclo Para, que se controla mediante un contador, el ciclo Mientras se basa en la evaluaci√≥n de una expresi√≥n booleana que determina si el bloque de instrucciones contin√∫a ejecut√°ndose o si finaliza. Esta estructura se utiliza ampliamente en algoritmos de control, validaci√≥n de datos y procesos donde la repetici√≥n depende del estado de una variable o entrada del usuario.</p>
              <p>La estructura general en PSeInt es la siguiente:.</p>

              <pre class="bg-slate-900 text-slate-100 p-4 rounded overflow-auto"><code>Mientras (condici√≥n) Hacer
   // Instrucciones
FinMientras</code></pre>
              <pre class="bg-slate-900 text-slate-100 p-4 rounded overflow-auto"><code>Proceso CicloMientras
   Definir i Como Entero
   i = 1
   Mientras i <= 5 Hacer
      Escribir "N√∫mero: ", i
      i = i + 1
   FinMientras
FinProceso</code></pre>
            <p> A continuaci√≥n, se muestra un ejemplo que imprime los n√∫meros del 1 al 5 utilizando un ciclo Mientras: </p> 
              <figure class="bg-white border border-emerald-200 rounded-lg p-4">
                <figcaption class="font-semibold text-emerald-800 mb-2">Figura 7. Ejemplo de ciclo Mientras (PSeInt) y salida</figcaption>
                <img src="img/Figura 5.png" alt="Ejemplo de ciclo Mientras en PSeInt y su ejecuci√≥n" class="w-full object-contain rounded"/>
              </figure>
            </article>

            <!-- 3.3.3 Repetir Mientras Que -->
            <article class="space-y-3">
              <h4 class="text-xl font-bold text-emerald-800">3.3.3 Ciclo Repetir Mientras Que (Do‚ÄìWhile)</h4>
              <p>El ciclo Repetir Mientras Que ejecuta un bloque de instrucciones al menos una vez, independientemente de si la condici√≥n es verdadera o falsa en la primera evaluaci√≥n. Esto se debe a que la condici√≥n se verifica al final del ciclo, no al inicio, lo que lo diferencia del ciclo Mientras, donde la evaluaci√≥n se realiza antes de entrar al bloque. De acuerdo con Programiz (2024), este tipo de bucle es ideal cuando se desea asegurar una primera ejecuci√≥n antes de validar la condici√≥n, como en procesos de validaci√≥n de entrada de datos o en la simulaci√≥n de men√∫s interactivos que deben mostrarse al menos una vez.</p>
              <pre class="bg-slate-900 text-slate-100 p-4 rounded overflow-auto"><code>Repetir
   // Instrucciones
Hasta Que (condici√≥n)</code></pre>
              <pre class="bg-slate-900 text-slate-100 p-4 rounded overflow-auto"><code>Proceso CicloRepetir
   Definir numero Como Entero
   Repetir
      Escribir "Ingrese un n√∫mero mayor que cero:"
      Leer numero
   Hasta Que numero > 0
   Escribir "N√∫mero v√°lido: ", numero
FinProceso</code></pre>
             <p> A continuaci√≥n, se presenta un ejemplo que solicita al usuario ingresar un n√∫mero mayor que cero, y repite el proceso mientras el n√∫mero digitado sea menor o igual a 0 </p> 
              <figure class="bg-white border border-emerald-200 rounded-lg p-4">
                <figcaption class="font-semibold text-emerald-800 mb-2">Figura 8. Ejemplo de ciclo Repetir Mientras Que (PSeInt)</figcaption>
                <img src="img/Figura 6.png" alt="Ejemplo de ciclo Repetir Mientras Que en PSeInt" class="w-full object-contain rounded"/>
              </figure>
            </article>
          </div>
        </details>

        

        <!-- 3.6 Control de ciclos: contador, acumulador, centinela -->
     
      </div>
    </section>

    <!-- ACTIVIDADES -->
    <section id="actividades" class="content-pane">
      <div class="flex justify-end">
        <div class="space-y-1">
          <div class="speech-controls p-2 bg-emerald-100 rounded-lg flex items-center flex-wrap gap-2 text-sm" data-target="actividades">
            <button class="play-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-1 px-3 rounded-full flex items-center"><span class="mr-1">‚ñ∂Ô∏è</span> Leer</button>
            <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚è∏Ô∏è</span> Pausar</button>
            <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚èπÔ∏è</span> Detener</button>
            <div class="flex items-center ml-2">
              <label class="text-xs text-emerald-800 mr-2">Velocidad:</label>
              <input type="range" class="speech-rate w-24" min="0.5" max="2" step="0.1" value="1"/>
            </div>
          </div>
          <div class="p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800 text-right max-w-xl w-full ml-auto">
            <strong>üí° Atajos:</strong> <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Espacio</kbd> reproducir/pausar ¬∑ <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Tab</kbd> detener
          </div>
        </div>
      </div>

      <h2 class="text-2xl sm:text-3xl font-bold text-emerald-800 mb-4">Actividades</h2>

      <!-- Actividad complementaria -->
      <article class="bg-white border-l-4 border-emerald-500 rounded-lg shadow-sm p-5 mb-6">
        <h3 class="text-xl font-bold text-emerald-700 mb-2">Actividad: promedio con centinela</h3>
        <p class="mb-3">
          Dise√±a un algoritmo en <em>PSeInt</em> Dise√±a un algoritmo que muestre en pantalla todos los n√∫meros pares comprendidos entre 1 y 20, 
          utilizando una <strong>estructura repetitiva</strong>.
        </p>
        <textarea rows="10" class="w-full p-3 border rounded bg-white" placeholder="Escribe aqu√≠ tu pseudoc√≥digo‚Ä¶"></textarea>
      </article>
    </section>

    <!-- EVALUACI√ìN -->
    <section id="evaluacion" class="content-pane">
      <div class="flex justify-end">
        <div class="space-y-1">
          <div class="speech-controls p-2 bg-emerald-100 rounded-lg flex items-center flex-wrap gap-2 text-sm" data-target="evaluacion">
            <button class="play-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-1 px-3 rounded-full flex items-center"><span class="mr-1">‚ñ∂Ô∏è</span> Leer</button>
            <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚è∏Ô∏è</span> Pausar</button>
            <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚èπÔ∏è</span> Detener</button>
            <div class="flex items-center ml-2">
              <label class="text-xs text-emerald-800 mr-2">Velocidad:</label>
              <input type="range" class="speech-rate w-24" min="0.5" max="2" step="0.1" value="1"/>
            </div>
          </div>
          <div class="p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800 text-right max-w-xl w-full ml-auto">
            <strong>üí° Atajos:</strong> <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Espacio</kbd> reproducir/pausar ¬∑ <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Tab</kbd> detener
          </div>
        </div>
      </div>

      <h2 class="text-2xl sm:text-3xl font-bold text-emerald-800 mb-4">Evaluaci√≥n</h2>
      <div class="bg-white p-5 rounded-lg shadow-md">
        <div id="quiz"></div>
        <button id="quiz-submit" class="mt-4 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded transition-colors">Finalizar</button>
        <div id="quiz-result" class="mt-3 text-lg font-bold"></div>
      </div>
    </section>

    <!-- RECURSOS -->
    <section id="recursos" class="content-pane">
      <div class="flex justify-end">
        <div class="space-y-1">
          <div class="speech-controls p-2 bg-emerald-100 rounded-lg flex items-center flex-wrap gap-2 text-sm" data-target="recursos">
            <button class="play-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-1 px-3 rounded-full flex items-center"><span class="mr-1">‚ñ∂Ô∏è</span> Leer</button>
            <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚è∏Ô∏è</span> Pausar</button>
            <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚èπÔ∏è</span> Detener</button>
            <div class="flex items-center ml-2">
              <label class="text-xs text-emerald-800 mr-2">Velocidad:</label>
              <input type="range" class="speech-rate w-24" min="0.5" max="2" step="0.1" value="1"/>
            </div>
          </div>
          <div class="p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800 text-right max-w-xl w-full ml-auto">
            <strong>üí° Atajos:</strong> <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Espacio</kbd> reproducir/pausar ¬∑ <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Tab</kbd> detener
          </div>
        </div>
      </div>

      <h2 class="text-2xl sm:text-3xl font-bold text-emerald-800 mb-6">Recursos</h2>
      <div class="grid lg:grid-cols-3 gap-5">
        <article class="bg-white rounded-2xl shadow-md border border-emerald-100 p-5">
          <h3 class="text-xl font-bold text-slate-900 leading-tight">L√≥gica de programaci√≥n</h3>
          <p class="text-sm text-slate-700 mt-2"><strong>Trejos Buritic√°, O. I.</strong> (2023). <em>L√≥gica de programaci√≥n</em>. Ediciones de la U.</p>
          <a href="https://www.edicionesdelau.com/" target="_blank" class="inline-block mt-3 text-emerald-700 underline">Ver recurso</a>
        </article>

        <article class="bg-white rounded-2xl shadow-md border border-emerald-100 p-5">
          <h3 class="text-xl font-bold text-slate-900 leading-tight">Solucionario en pseudoc√≥digo</h3>
          <p class="text-sm text-slate-700 mt-2"><strong>Trejos Buritic√°, O. I.</strong> (2021). <em>L√≥gica de programaci√≥n: solucionario en pseudoc√≥digo. Ejercicios resueltos</em>. Ediciones de la U.</p>
          <a href="https://www.edicionesdelau.com/" target="_blank" class="inline-block mt-3 text-emerald-700 underline">Ver recurso</a>
        </article>

        <article class="bg-white rounded-2xl shadow-md border border-emerald-100 p-5">
          <h3 class="text-xl font-bold text-slate-900 leading-tight">Fundamentos de programaci√≥n usando PSeInt</h3>
          <p class="text-sm text-slate-700 mt-2"><strong>Garc√≠a Santill√°n, I.</strong> (Ed.). (2014). <em>Fundamentos de programaci√≥n usando PSeInt</em>. UPDCA.</p>
          <a href="#" target="_blank" class="inline-block mt-3 text-emerald-700 underline">Ver recurso</a>
        </article>
      </div>
    </section>

    <!-- BIBLIOGRAF√çA -->
    <section id="bibliografia" class="content-pane">
      <div class="flex justify-end">
        <div class="space-y-1">
          <div class="speech-controls p-2 bg-emerald-100 rounded-lg flex items-center flex-wrap gap-2 text-sm" data-target="bibliografia">
            <button class="play-btn bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-1 px-3 rounded-full flex items-center"><span class="mr-1">‚ñ∂Ô∏è</span> Leer</button>
            <button class="pause-btn bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚è∏Ô∏è</span> Pausar</button>
            <button class="stop-btn bg-red-500 hover:bg-red-600 text-white font-medium py-1 px-3 rounded-full flex items-center" disabled><span class="mr-1">‚èπÔ∏è</span> Detener</button>
            <div class="flex items-center ml-2">
              <label class="text-xs text-emerald-800 mr-2">Velocidad:</label>
              <input type="range" class="speech-rate w-24" min="0.5" max="2" step="0.1" value="1"/>
            </div>
          </div>
          <div class="p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800 text-right max-w-xl w-full ml-auto">
            <strong>üí° Atajos:</strong> <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Espacio</kbd> reproducir/pausar ¬∑ <kbd class="bg-white px-2 py-0.5 rounded border text-[10px]">Tab</kbd> detener
          </div>
        </div>
      </div>

      <h2 class="text-2xl sm:text-3xl font-bold text-emerald-800 mb-4">Bibliograf√≠a</h2>
      <ul class="space-y-3">
        <li class="bg-white p-4 rounded-lg border-l-4 border-emerald-500 shadow-sm">
          Trejos Buritic√°, O. I. (2023). <em>L√≥gica de programaci√≥n</em>. Ediciones de la U.
        </li>
        <li class="bg-white p-4 rounded-lg border-l-4 border-emerald-500 shadow-sm">
          Trejos Buritic√°, O. I. (2021). <em>L√≥gica de programaci√≥n: solucionario en pseudoc√≥digo. Ejercicios resueltos</em>. Ediciones de la U.
        </li>
        <li class="bg-white p-4 rounded-lg border-l-4 border-emerald-500 shadow-sm">
          Garc√≠a Santill√°n, I. (Ed.). (2014). <em>Fundamentos de programaci√≥n usando PSeInt</em>. Unidad de Producci√≥n y Difusi√≥n Cient√≠fica y Acad√©mica.
        </li>
        <li class="bg-white p-4 rounded-lg border-l-4 border-emerald-500 shadow-sm">
          GeeksforGeeks. (2025, enero 8). <em>Iteration statements in programming</em>. GeeksforGeeks.
        </li>
        <li class="bg-white p-4 rounded-lg border-l-4 border-emerald-500 shadow-sm">
          Programiz. (2024). <em>Do while loop in programming</em>.
        </li>
      </ul>

      <footer class="mt-10 pt-6 border-t text-center text-slate-600">
        <p class="font-medium">Unic√≥rdoba, calidad, innovaci√≥n e inclusi√≥n para la transformaci√≥n del territorio.</p>
        <a class="text-emerald-700 underline" href="https://www.unicordoba.edu.co" target="_blank">www.unicordoba.edu.co</a>
      </footer>
    </section>

  </main>
</div>

<!-- Modal de imagen -->
<div id="imgModal" class="fixed inset-0 bg-black/80 hidden place-items-center z-[1000]">
  <img id="imgModalSrc" src="" alt="Vista ampliada" class="max-w-[92vw] max-h-[92vh] border-4 border-white rounded shadow-2xl"/>
</div>

<script>
(() => {
  const panes = document.querySelectorAll('.content-pane');
  const links = document.querySelectorAll('.sidebar-link');
  const mobileNav = document.getElementById('mobile-nav');

  function go(id){
    panes.forEach(p=>p.classList.remove('active'));
    document.getElementById(id)?.classList.add('active');
    links.forEach(a=>{
      const active = a.dataset.target===id;
      a.classList.toggle('active', active);
      a.setAttribute('aria-current', active ? 'page' : 'false');
    });
    if(mobileNav) mobileNav.value=id;
    window.scrollTo({top:0,behavior:'smooth'});
  }

  // TTS (toggle)
  const synth = window.speechSynthesis;
  let voices = [];
  function loadVoices(){ voices = synth.getVoices(); }
  loadVoices();
  if (synth.onvoiceschanged !== undefined) synth.onvoiceschanged = loadVoices;

  let menuTtsEnabled = JSON.parse(localStorage.getItem('menuTtsEnabled') || 'false');
  const ttsBtn = document.getElementById('menu-tts-toggle');

  function updateTtsBtn(){
    if(!ttsBtn) return;
    ttsBtn.classList.toggle('muted', !menuTtsEnabled);
    ttsBtn.setAttribute('aria-pressed', menuTtsEnabled ? 'true' : 'false');
    ttsBtn.setAttribute('aria-label', menuTtsEnabled ? 'Voz activada' : 'Voz desactivada');
    ttsBtn.title = menuTtsEnabled ? 'Voz activada' : 'Voz desactivada';
    ttsBtn.textContent = menuTtsEnabled ? 'üîä' : 'üîá';
  }
  updateTtsBtn();

  ttsBtn?.addEventListener('click', () => {
    menuTtsEnabled = !menuTtsEnabled;
    localStorage.setItem('menuTtsEnabled', JSON.stringify(menuTtsEnabled));
    if(!menuTtsEnabled) synth.cancel();
    updateTtsBtn();
  });

  function speakMenu(text){
    if(!menuTtsEnabled || !text) return;
    try{
      synth.cancel();
      const u = new SpeechSynthesisUtterance(text);
      const v = voices.find(v => /es/i.test(v.lang)) || null;
      if (v) u.voice = v, u.lang = v.lang; else u.lang = 'es-ES';
      u.rate = 1.0;
      synth.speak(u);
    }catch(e){}
  }

  links.forEach(a => {
    a.addEventListener('click', (e) => {
      e.preventDefault();
      const id = a.dataset.target;
      if (id) go(id);
      const label = a.getAttribute('aria-label') || a.textContent.replace(/\s+/g,' ').trim();
      speakMenu(label);
    });
  });

  mobileNav?.addEventListener('change', e => {
    go(e.target.value);
    const opt = e.target.selectedOptions[0];
    const label = (opt?.textContent || '').replace(/\s+/g,' ').trim();
    speakMenu(label);
  });
})();
</script>

<script>
// Zoom ligero de figuras
const modal = document.getElementById('imgModal');
const modalImg = document.getElementById('imgModalSrc');
document.querySelectorAll('figure img').forEach(img=>{
  img.classList.add('cursor-zoom-in');
  img.addEventListener('click', ()=>{ modal.classList.remove('hidden'); modalImg.src = img.src; });
});
modal?.addEventListener('click', ()=>modal.classList.add('hidden'));
</script>

<script>
// ===== Evaluaci√≥n: 6 preguntas tipo Saber Pro =====
const quizData = [
  { q: "¬øQu√© es una iteraci√≥n en programaci√≥n?", opts: [
      "Una instrucci√≥n que se ejecuta solo una vez.",
      "Un mecanismo para repetir un bloque bajo una condici√≥n o un n√∫mero de veces.",
      "Una forma de declarar variables globales.",
      "Un m√©todo para capturar errores."
    ], a: 1
  },
  { q: "Salida del siguiente c√≥digo (PSeInt):\n\nProceso ContadorBasico\n  Definir i Como Entero\n  i = 1\n  Mientras i <= 3 Hacer\n    Escribir \"Iteraci√≥n \", i\n    i = i + 1\n  FinMientras\nFinProceso", opts: [
      "Iteraci√≥n 1, Iteraci√≥n 2, Iteraci√≥n 3",
      "Iteraci√≥n 0, Iteraci√≥n 1, Iteraci√≥n 2",
      "Iteraci√≥n 1, Iteraci√≥n 2, Iteraci√≥n 3, Iteraci√≥n 4",
      "Iteraci√≥n 2, Iteraci√≥n 3, Iteraci√≥n 4"
    ], a: 0
  },
  { q: "En un ciclo Repetir Mientras Que, ¬øqu√© caracter√≠stica lo diferencia del Mientras?", opts: [
      "Se eval√∫a la condici√≥n antes de entrar al bloque.",
      "Siempre termina despu√©s de 3 iteraciones.",
      "Ejecuta el bloque al menos una vez y eval√∫a al final.",
      "No permite leer datos del usuario."
    ], a: 2
  },
  { q: "¬øQu√© imprimir√° este c√≥digo?\n\nProceso RangoYpaso\n  Definir i Como Entero\n  Para i = 2 Hasta 10 Con Paso 3 Hacer\n    Escribir i\n  FinPara\nFinProceso", opts: [
      "2, 3, 4, 5, 6, 7, 8, 9, 10",
      "2, 5, 8",
      "2, 5, 8, 11",
      "3, 6, 9"
    ], a: 1
  },
  { q: "En bucles anidados, si el externo itera 2 veces y el interno 3 veces, ¬øcu√°ntas l√≠neas se imprimen?", opts: [
      "3", "5", "6", "9"
    ], a: 2
  },
  { q: "¬øQu√© mostrar√° el programa?\n\nProceso Calculo\n  Definir i, suma Como Entero\n  suma = 0\n  Para i = 5 Hasta 1 Con Paso -2 Hacer\n    suma = suma + i\n  FinPara\n  Escribir \"Suma total: \", suma\nFinProceso", opts: [
      "Suma total: 9", "Suma total: 6", "Suma total: 8", "Suma total: 12"
    ], a: 0
  }
];

const quiz = document.getElementById('quiz');
if(quiz){
  quizData.forEach((it,i)=>{
    const wrap = document.createElement('div'); wrap.className='mb-5';
    wrap.innerHTML = `<p class='font-semibold mb-2 whitespace-pre-line'>${i+1}. ${it.q}</p>`;
    it.opts.forEach((op,idx)=>{
      const d=document.createElement('div');
      d.className='quiz-option p-3 border-2 border-slate-200 rounded-lg cursor-pointer mb-2';
      d.textContent=op;
      d.addEventListener('click',()=>{
        wrap.querySelectorAll('.quiz-option').forEach(x=>x.classList.remove('selected'));
        d.classList.add('selected');
      });
      wrap.appendChild(d);
    });
    quiz.appendChild(wrap);
  });
  document.getElementById('quiz-submit').addEventListener('click',()=>{
    let score=0;
    [...quiz.children].forEach((block,i)=>{
      const sel = block.querySelector('.quiz-option.selected'); 
      if(sel && sel.textContent===quizData[i].opts[quizData[i].a]) score++;
    });
    const pct = score/quizData.length;
    const out=document.getElementById('quiz-result');
    out.textContent = `Puntaje: ${score}/${quizData.length} (${Math.round(pct*100)}%).`;
    out.className='mt-3 text-lg font-bold ' + (pct>=0.7?'text-emerald-700':'text-red-700');
    if(window.SCORM12) SCORM12.setScore(pct);
    window.scrollTo({top:0,behavior:'smooth'});
  });
}
</script>

<!-- TTS secciones (lee titulares y p√°rrafos/figcaptions) -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  const synth = window.speechSynthesis;
  let voices = [], preferred = null;

  function loadVoices(){
    voices = synth.getVoices();
    preferred = voices.find(v => v.name.includes('Paulina'))
             || voices.find(v => (v.lang||'').toLowerCase().startsWith('es'))
             || voices[0] || null;
  }
  loadVoices();
  if (synth.onvoiceschanged !== undefined) synth.onvoiceschanged = loadVoices;

  document.querySelectorAll('.speech-controls[data-target]').forEach(controls => {
    const targetId = controls.dataset.target;
    const section  = document.getElementById(targetId);
    if (!section) return;

    const playBtn  = controls.querySelector('.play-btn');
    const pauseBtn = controls.querySelector('.pause-btn');
    const stopBtn  = controls.querySelector('.stop-btn');
    const rateCtrl = controls.querySelector('.speech-rate');

    let currentUtterance = null, isPaused = false;

    function getTextFromSection(sec){
      const nodes = sec.querySelectorAll('h1,h2,h3,h4,h5,h6,p,li,figcaption,pre');
      if (!nodes.length) return (sec.textContent||'').trim();
      let text = '';
      nodes.forEach(el=>{
        const t=(el.textContent||'').trim();
        if (!t) return;
        text += (/^H[1-6]$/.test(el.tagName) ? t + '. . . ' : t + ' ');
      });
      return text.trim();
    }
    function setButtons(playing){
      playBtn.disabled  = playing && !isPaused;
      pauseBtn.disabled = !playing;
      stopBtn.disabled  = !playing;
    }
    function stop(){
      if (synth.speaking || synth.pending) synth.cancel();
      currentUtterance=null; isPaused=false; setButtons(false);
    }
    function play(){
      if (currentUtterance && isPaused && synth.speaking){
        synth.resume(); isPaused=false; setButtons(true); return;
      }
      stop();
      const text=getTextFromSection(section);
      if (!text) return;
      const utt=new SpeechSynthesisUtterance(text);
      utt.lang  =(preferred && preferred.lang) || 'es-ES';
      utt.voice = preferred || null;
      utt.rate  = parseFloat(rateCtrl?.value || '1');
      utt.onend   = ()=>{ currentUtterance=null; setButtons(false); };
      utt.onerror = ()=>{ currentUtterance=null; setButtons(false); };
      currentUtterance=utt; synth.speak(utt); isPaused=false; setButtons(true);
    }
    function pause(){
      if (currentUtterance && !isPaused && synth.speaking){
        synth.pause(); isPaused=true; playBtn.disabled=false;
      }
    }

    playBtn?.addEventListener('click',  play);
    pauseBtn?.addEventListener('click', pause);
    stopBtn?.addEventListener('click',  stop);
    rateCtrl?.addEventListener('change', ()=>{ if (currentUtterance && !isPaused && synth.speaking){ stop(); setTimeout(play,80);} });

    // Atajos con la secci√≥n visible
    document.addEventListener('keydown', (e)=>{
      const activePane = document.querySelector('.content-pane.active');
      if (!activePane || activePane.id !== targetId) return;
      if (e.target.tagName==='INPUT' || e.target.tagName==='TEXTAREA') return;
      if (e.code==='Space'){ e.preventDefault(); (currentUtterance && !isPaused && synth.speaking) ? pause() : play(); }
      if (e.code==='Tab' && !e.shiftKey){ stop(); }
    });
  });
});
</script>

<!-- TTS acorde√≥n (lee solo el details abierto) -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const synth = window.speechSynthesis;
  let voices=[], preferred=null;
  function loadVoices(){
    voices = synth.getVoices();
    preferred = voices.find(v=>v.name.includes('Paulina'))
             || voices.find(v=>(v.lang||'').toLowerCase().startsWith('es'))
             || voices[0] || null;
  }
  loadVoices();
  if (synth.onvoiceschanged!==undefined) synth.onvoiceschanged=loadVoices;

  const ctrl = document.querySelector('.speech-controls[data-mode="accordion"][data-container="#contenido"]');
  if (!ctrl) return;
  const container = document.querySelector('#contenido');

  const playBtn  = ctrl.querySelector('.play-btn');
  const pauseBtn = ctrl.querySelector('.pause-btn');
  const stopBtn  = ctrl.querySelector('.stop-btn');
  const rateCtrl = ctrl.querySelector('.speech-rate');

  let currentUtterance=null, isPaused=false;

  function getActiveDetails(){ return container.querySelector('details[open]') || container.querySelector('details'); }
  function getDetailsText(det){
    if (!det) return '';
    const parts=[];
    const sum=det.querySelector(':scope > summary');
    if (sum){ const t=(sum.textContent||'').trim(); if (t) parts.push(t + '. . . '); }
    const bodyNodes = det.querySelectorAll(':scope > :not(summary)');
    if (bodyNodes.length){
      bodyNodes.forEach(n=>{
        n.querySelectorAll('h1,h2,h3,h4,h5,h6,p,li,figcaption,pre').forEach(el=>{
          const t=(el.textContent||'').trim(); if (t) parts.push(t + ' ');
        });
        if (!n.querySelector('h1,h2,h3,h4,h5,h6,p,li,figcaption,pre')){
          const t=(n.textContent||'').trim(); if (t) parts.push(t + ' ');
        }
      });
    }else{
      const t=(det.textContent||'').trim(); if (t) parts.push(t);
    }
    return parts.join('').trim();
  }
  function setButtons(playing){
    playBtn.disabled  = playing && !isPaused;
    pauseBtn.disabled = !playing;
    stopBtn.disabled  = !playing;
  }
  function stop(){
    if (synth.speaking || synth.pending) synth.cancel();
    currentUtterance=null; isPaused=false; setButtons(false);
  }
  function play(){
    if (currentUtterance && isPaused && synth.speaking){ synth.resume(); isPaused=false; setButtons(true); return; }
    stop();
    const det=getActiveDetails(); const text=getDetailsText(det);
    if (!text) return;
    const utt=new SpeechSynthesisUtterance(text);
    utt.lang  =(preferred && preferred.lang) || 'es-ES';
    utt.voice = preferred || null;
    utt.rate  = parseFloat(rateCtrl?.value || '1');
    utt.onend   = ()=>{ currentUtterance=null; setButtons(false); };
    utt.onerror = ()=>{ currentUtterance=null; setButtons(false); };
    currentUtterance=utt; synth.speak(utt); isPaused=false; setButtons(true);
  }
  function pause(){ if (currentUtterance && !isPaused && synth.speaking){ synth.pause(); isPaused=true; playBtn.disabled=false; } }

  playBtn.addEventListener('click',  play);
  pauseBtn.addEventListener('click', pause);
  stopBtn.addEventListener('click',  stop);
  rateCtrl?.addEventListener('change', ()=>{ if (currentUtterance && !isPaused && synth.speaking){ stop(); setTimeout(play,80);} });

  container.querySelectorAll('details').forEach(d=>{ d.addEventListener('toggle', ()=>{ if (d.open) stop(); }); });

  document.addEventListener('keydown', (e)=>{
    const activePane=document.querySelector('.content-pane.active');
    if (!activePane || activePane.id!=='contenido') return;
    if (e.target.tagName==='INPUT' || e.target.tagName==='TEXTAREA') return;
    if (e.code==='Space'){ e.preventDefault(); (currentUtterance && !isPaused && synth.speaking) ? pause() : play(); }
    if (e.code==='Tab' && !e.shiftKey){ stop(); }
    if (e.code==='Escape'){ stop(); }
  });
});
</script>

</body>
</html>

