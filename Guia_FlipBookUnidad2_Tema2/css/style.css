*{box-sizing:border-box}
:root{
  --bg1:#0d1117; --bg2:#111827; --paper:#ffffff; --ink:#0b0f16;
  --shadow: rgba(0,0,0,.35); --shadow-strong: rgba(0,0,0,.55);
  --accent:#94a3b8;
}
html,body{height:100%}
body{
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, sans-serif;
  margin:0; color:#e5e7eb; background: radial-gradient(1200px 700px at 50% 40%, #1f293780 0%, #0b0f16 55%, #05070b 100%), linear-gradient(180deg, var(--bg1), var(--bg2));
  display:flex; flex-direction:column;
}
.book{
  flex:1; display:flex; justify-content:center; align-items:center;
  gap:16px; padding:24px 12px;
  perspective: 1800px;
}
.stage{
  display:flex; gap:16px; align-items:center; justify-content:center;
  filter: drop-shadow(0 30px 50px rgba(0,0,0,.45));
}
.page{
  background: var(--paper);
  color: var(--ink);
  position:relative;
  box-shadow: 0 14px 28px var(--shadow), 0 8px 10px rgba(0,0,0,.12);
  transform-style: preserve-3d;
  backface-visibility: hidden;
  overflow:hidden;
  border-radius: 4px;
}
.page img{display:block; width:100%; height:auto;}
.page::before{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background:
    radial-gradient(120% 90% at 50% 10%, rgba(255,255,255,.35), rgba(255,255,255,0) 50%) ,
    linear-gradient( to right, rgba(0,0,0,.08), rgba(0,0,0,0) 30%, rgba(0,0,0,0) 70%, rgba(0,0,0,.08) );
  mix-blend-mode: multiply;
  opacity:.55;
}
.book::after{
  content:"";
  position:fixed; inset:0;
  pointer-events:none;
  background: radial-gradient(1200px 600px at 50% 40%, rgba(255,255,255,.06), rgba(0,0,0,0) 65%) ;
}
@media (min-width: 768px){
  .page{ width: 40vw; max-width: 800px; }
}
@media (max-width: 767px){
  .stage{gap:0}
  .page{ width: 94vw; max-width: 94vw; }
}
.controls{
  position:sticky; bottom:0; left:0; right:0;
  background: linear-gradient(180deg, rgba(15,18,25,.6), rgba(10,12,18,.85));
  border-top: 1px solid rgba(148,163,184,.2);
  padding:10px 12px;
}
.controls .guide{font-size:14px; color:#cbd5e1; margin-bottom:6px; text-align:center}
.controls .buttons{display:flex; gap:8px; justify-content:center; align-items:center; flex-wrap:wrap}
.controls button{
  border:1px solid rgba(148,163,184,.35); color:#e5e7eb; background: #0b1220;
  padding:8px 12px; border-radius:10px; cursor:pointer;
}
.controls button:hover{background:#0f172a}
.controls button:disabled{opacity:.5; cursor:not-allowed}
.controls input[type=number]{
  width:96px; padding:8px 10px; border:1px solid rgba(148,163,184,.35); border-radius:10px;
  background:#0b1220; color:#e5e7eb;
}
.sr-only{
  position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0;
}
/* Animación realista */
.turning-next{ animation: leafTurnNext 800ms cubic-bezier(.3,.1,.1,1) forwards; }
.turning-prev{ animation: leafTurnPrev 800ms cubic-bezier(.3,.1,.1,1) forwards; }
.page::after{
  content:"";
  position:absolute; inset:0; pointer-events:none;
  background: linear-gradient( to left, rgba(0,0,0,.25), rgba(0,0,0,0) 35% );
  opacity:0; transition: opacity .2s ease;
}
.page.turning-next::after{ opacity: .65; }
.page.turning-prev::after{ opacity: .65; background: linear-gradient( to right, rgba(0,0,0,.25), rgba(0,0,0,0) 35% ); }
@keyframes leafTurnNext{
  0%   { transform: rotateY(0deg);   filter: brightness(1); }
  40%  { transform: rotateY(-70deg); filter: brightness(.98); }
  70%  { transform: rotateY(-150deg); filter: brightness(.95); }
  100% { transform: rotateY(-179.9deg); filter: brightness(1); }
}
@keyframes leafTurnPrev{
  0%   { transform: rotateY(0deg);    filter: brightness(1); }
  40%  { transform: rotateY(70deg);   filter: brightness(.98); }
  70%  { transform: rotateY(150deg);  filter: brightness(.95); }
  100% { transform: rotateY(179.9deg); filter: brightness(1); }
}
.page.right{ transform-origin: left center; }
.page.left { transform-origin: right center; }


/* === Corner-peel page turn (desde la esquina) === */
.page{ position:relative; overflow:hidden; }
.page .curl{
  position:absolute; right:0; bottom:0; width:14%; height:14%; pointer-events:none;
  background:
    radial-gradient(12px 12px at 100% 100%, rgba(0,0,0,.25), rgba(0,0,0,0) 70%),
    linear-gradient(135deg, #e7eef9, #ffffff 45%);
  clip-path: polygon(100% 0, 100% 100%, 0 100%);
  opacity:0;
  filter: drop-shadow(-6px -6px 10px rgba(0,0,0,.25));
  z-index:3;
}
.page.right.peel-next .curl,
.page.left.peel-prev .curl{ opacity:1; }

.peel-next{ animation: peelNext 700ms cubic-bezier(.2,.55,.1,1) forwards; transform-origin: 100% 100%; }
.peel-prev{ animation: peelPrev 700ms cubic-bezier(.2,.55,.1,1) forwards; transform-origin: 0% 100%; }

/* sombras dinámicas durante el despegue */
.page.peel-next::after{ opacity:.55; background: linear-gradient(225deg, rgba(0,0,0,.28), rgba(0,0,0,0) 55%);}
.page.peel-prev::after{ opacity:.55; background: linear-gradient(315deg, rgba(0,0,0,.28), rgba(0,0,0,0) 55%);}

/* Animación de la "esquina" que se levanta */
@keyframes curlGrow{0%{opacity:0}100%{opacity:1}}
  50% { width:20%; height:20%; }
  100% { width:32%; height:32%; }
}

/* Giro con ligera torsión y elevación desde la esquina inferior */
@keyframes peelNext{
  0%   { transform: rotateY(0) rotateX(0) rotateZ(0) translateY(0); }
  30%  { transform: rotateY(-45deg) rotateX(2deg) rotateZ(0.4deg) translateY(-1px); }
  60%  { transform: rotateY(-120deg) rotateX(4deg) rotateZ(0.8deg) translateY(-2px); }
  100% { transform: rotateY(-179.9deg) rotateX(0) rotateZ(0) translateY(0); }
}
  35%  { transform: rotateY(-40deg) rotateX(3deg) rotateZ(0.8deg) translateY(-2px); }
  70%  { transform: rotateY(-120deg) rotateX(6deg) rotateZ(1.2deg) translateY(-3px); }
  100% { transform: rotateY(-179.9deg) rotateX(0) rotateZ(0) translateY(0); }
}
@keyframes peelPrev{
  0%   { transform: rotateY(0) rotateX(0) rotateZ(0) translateY(0); }
  30%  { transform: rotateY(45deg) rotateX(2deg) rotateZ(-0.4deg) translateY(-1px); }
  60%  { transform: rotateY(120deg) rotateX(4deg) rotateZ(-0.8deg) translateY(-2px); }
  100% { transform: rotateY(179.9deg) rotateX(0) rotateZ(0) translateY(0); }
}
  35%  { transform: rotateY(40deg) rotateX(3deg) rotateZ(-0.8deg) translateY(-2px); }
  70%  { transform: rotateY(120deg) rotateX(6deg) rotateZ(-1.2deg) translateY(-3px); }
  100% { transform: rotateY(179.9deg) rotateX(0) rotateZ(0) translateY(0); }
}

/* activar la animación de la esquina mientras gira */
.page.peel-next .curl, .page.peel-prev .curl{ animation: curlGrow 700ms ease forwards; }
